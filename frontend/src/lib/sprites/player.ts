import type { CharacterSprite, Palette, SpriteFrame } from './types'

/**
 * Player character — 14-color RPG adventurer
 *
 * Palette:
 *  0  transparent
 *  1  outline (#1A1A2E)
 *  2  hair dark
 *  3  hair mid
 *  4  skin
 *  5  skin shadow
 *  6  shirt primary (blue — matches PLAYER_COLOR)
 *  7  shirt shadow
 *  8  shirt dark
 *  9  pants
 * 10  pants shadow
 * 11  white (eyes / highlights)
 * 12  eye pupil
 * 13  belt / accessory
 */
const PALETTE: Palette = [
  '',          // 0
  '#1A1A2E',  // 1  outline
  '#2B1B4E',  // 2  hair dark
  '#4B3A8E',  // 3  hair mid
  '#F5D6B8',  // 4  skin
  '#E8C4A0',  // 5  skin shadow
  '#3B82F6',  // 6  shirt
  '#2563EB',  // 7  shirt shadow
  '#1D4ED8',  // 8  shirt dark
  '#7C6930',  // 9  pants
  '#5C4E20',  // 10 pants shadow
  '#FFFFFF',  // 11 white
  '#111111',  // 12 pupil
  '#D97706',  // 13 belt
]

// ─── DOWN ────────────────────────────────────────────
const DOWN_IDLE: SpriteFrame = [
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 3, 3, 3, 3, 3, 3, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 3, 3, 2, 3, 3, 2, 3, 3, 1, 0, 0, 0],
  [0, 0, 0, 1, 4, 4, 4, 4, 4, 4, 4, 4, 1, 0, 0, 0],
  [0, 0, 0, 1, 4, 11, 12, 4, 4, 11, 12, 4, 1, 0, 0, 0],
  [0, 0, 0, 1, 5, 4, 4, 4, 4, 4, 4, 5, 1, 0, 0, 0],
  [0, 0, 0, 0, 1, 4, 4, 5, 4, 4, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 7, 6, 6, 6, 7, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 7, 6, 6, 13, 6, 6, 7, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 8, 7, 6, 13, 6, 7, 8, 1, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 8, 7, 7, 7, 8, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 10, 1, 10, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 10, 1, 0, 1, 10, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
]

const DOWN_WALK1: SpriteFrame = [
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 3, 3, 3, 3, 3, 3, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 3, 3, 2, 3, 3, 2, 3, 3, 1, 0, 0, 0],
  [0, 0, 0, 1, 4, 4, 4, 4, 4, 4, 4, 4, 1, 0, 0, 0],
  [0, 0, 0, 1, 4, 11, 12, 4, 4, 11, 12, 4, 1, 0, 0, 0],
  [0, 0, 0, 1, 5, 4, 4, 4, 4, 4, 4, 5, 1, 0, 0, 0],
  [0, 0, 0, 0, 1, 4, 4, 5, 4, 4, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 7, 6, 6, 6, 7, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 7, 6, 6, 13, 6, 6, 7, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 8, 7, 6, 13, 6, 7, 8, 1, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 8, 7, 7, 7, 8, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 9, 10, 1, 0, 0, 10, 9, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 10, 1, 0, 0, 0, 0, 1, 10, 1, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
]

const DOWN_WALK2: SpriteFrame = [
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 3, 3, 3, 3, 3, 3, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 3, 3, 2, 3, 3, 2, 3, 3, 1, 0, 0, 0],
  [0, 0, 0, 1, 4, 4, 4, 4, 4, 4, 4, 4, 1, 0, 0, 0],
  [0, 0, 0, 1, 4, 11, 12, 4, 4, 11, 12, 4, 1, 0, 0, 0],
  [0, 0, 0, 1, 5, 4, 4, 4, 4, 4, 4, 5, 1, 0, 0, 0],
  [0, 0, 0, 0, 1, 4, 4, 5, 4, 4, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 7, 6, 6, 6, 7, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 7, 6, 6, 13, 6, 6, 7, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 8, 7, 6, 13, 6, 7, 8, 1, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 8, 7, 7, 7, 8, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 10, 0, 1, 10, 9, 1, 0, 0, 0, 0],
  [0, 0, 1, 10, 1, 0, 0, 0, 0, 1, 10, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
]

// ─── UP ──────────────────────────────────────────────
const UP_IDLE: SpriteFrame = [
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 2, 2, 3, 2, 2, 3, 2, 2, 1, 0, 0, 0],
  [0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 0, 0],
  [0, 0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 0, 0],
  [0, 0, 0, 1, 5, 5, 4, 4, 4, 4, 5, 5, 1, 0, 0, 0],
  [0, 0, 0, 0, 1, 5, 4, 4, 4, 5, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 7, 6, 6, 6, 7, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 7, 6, 6, 13, 6, 6, 7, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 8, 7, 6, 13, 6, 7, 8, 1, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 8, 7, 7, 7, 8, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 10, 1, 10, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 10, 1, 0, 1, 10, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
]

const UP_WALK1: SpriteFrame = [
  ...UP_IDLE.slice(0, 12),
  [0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 9, 10, 1, 0, 0, 10, 9, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 10, 1, 0, 0, 0, 0, 1, 10, 1, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
]

const UP_WALK2: SpriteFrame = [
  ...UP_IDLE.slice(0, 12),
  [0, 0, 0, 0, 1, 9, 9, 9, 9, 9, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 10, 0, 1, 10, 9, 1, 0, 0, 0, 0],
  [0, 0, 1, 10, 1, 0, 0, 0, 0, 1, 10, 1, 0, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
]

// ─── LEFT ────────────────────────────────────────────
const LEFT_IDLE: SpriteFrame = [
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 3, 3, 3, 3, 2, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 3, 3, 2, 3, 2, 2, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 4, 4, 4, 4, 4, 4, 1, 0, 0, 0, 0, 0],
  [0, 0, 1, 4, 11, 12, 4, 4, 4, 4, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 5, 4, 4, 4, 4, 5, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 4, 5, 4, 4, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 6, 6, 6, 7, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 6, 6, 13, 6, 7, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 7, 6, 13, 7, 8, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 7, 7, 8, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 9, 9, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 9, 10, 9, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 10, 1, 10, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
]

const LEFT_WALK1: SpriteFrame = [
  ...LEFT_IDLE.slice(0, 12),
  [0, 0, 0, 0, 1, 9, 9, 9, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 9, 10, 1, 10, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 1, 10, 1, 0, 0, 1, 10, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
]

const LEFT_WALK2: SpriteFrame = [
  ...LEFT_IDLE.slice(0, 12),
  [0, 0, 0, 0, 1, 9, 9, 9, 1, 0, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 10, 1, 9, 10, 1, 0, 0, 0, 0, 0, 0],
  [0, 0, 0, 1, 10, 1, 0, 0, 1, 10, 1, 0, 0, 0, 0, 0],
  [0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
]

// ─── RIGHT (mirror of LEFT) ─────────────────────────
function mirrorFrame(f: SpriteFrame): SpriteFrame {
  return f.map(row => [...row].reverse())
}

const RIGHT_IDLE = mirrorFrame(LEFT_IDLE)
const RIGHT_WALK1 = mirrorFrame(LEFT_WALK1)
const RIGHT_WALK2 = mirrorFrame(LEFT_WALK2)

// ─── Export ──────────────────────────────────────────
export const PLAYER_SPRITE: CharacterSprite = {
  name: 'player',
  palette: PALETTE,
  frames: {
    down: [DOWN_IDLE, DOWN_WALK1, DOWN_WALK2],
    up: [UP_IDLE, UP_WALK1, UP_WALK2],
    left: [LEFT_IDLE, LEFT_WALK1, LEFT_WALK2],
    right: [RIGHT_IDLE, RIGHT_WALK1, RIGHT_WALK2],
  },
}

/** Base palette (exported for friend palette swapping) */
export const PLAYER_PALETTE = PALETTE
